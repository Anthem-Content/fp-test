---
import Title from "./Title.astro";
import UniversalImage from "./UniversalImage.astro";
import "../../node_modules/@glidejs/glide/dist/css/glide.core.min.css";

interface Testimonial {
  quote: string;
  image: ImageMetadata | string;
}

const testimonials: Testimonial[] = [
  {
    quote:
      "The service has been a game-changer for our firm. We never worry about website updates anymore.",
    image: "https://picsum.photos/600/750?random=1",
  },
  {
    quote:
      "Switching to Firm Page was the best decision we made for our online presence.",
    image: "https://picsum.photos/600/750?random=2",
  },
  {
    quote:
      "The ongoing support and updates have made managing our website effortless.",
    image: "https://picsum.photos/600/750?random=3",
  },
  {
    quote:
      "Their team's responsiveness and attention to detail is outstanding.",
    image: "https://picsum.photos/600/750?random=4",
  },
  {
    quote: "We've received countless compliments on our new website.",
    image: "https://picsum.photos/600/750?random=5",
  },
];
---

<section class="section has-background-dark">
  <div class="container is-max-widescreen">
    <div class="columns is-vcentered">
      <div class="column is-4 p-6">
        <Title
          size={2}
          class="has-text-white is-1 mb-6"
          preHeading="Our Kind of Clients"
          text="Don't take our word for it"
        />
        <a href="/projects" class="button is-warning is-outlined"
          >See Our Work</a
        >
      </div>
      <div class="column is-8">
        <div class="glide testimonial-slider">
          <div class="glide__track" data-glide-el="track">
            <ul class="glide__slides">
              {
                testimonials.map((testimonial) => (
                  <li class="glide__slide">
                    <div class="testimonial-card px-4">
                      <UniversalImage
                        src={testimonial.image}
                        alt={testimonial.quote}
                        class="is-4by5 object-cover"
                      />
                      <p class="has-text-white mt-4">{testimonial.quote}</p>
                    </div>
                  </li>
                ))
              }
            </ul>
          </div>

          <div class="glide__bullets mt-6 ml-4" data-glide-el="controls[nav]">
            {
              testimonials.map((_, index) => (
                <button
                  class="glide__bullet"
                  data-glide-dir={`=${index}`}
                  aria-label={`Go to slide ${index + 1}`}
                />
              ))
            }
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .testimonial-slider {
    width: 100%;
    overflow: hidden;
  }

  .glide__slide {
    height: auto;
  }

  .glide__slides {
    align-items: stretch !important;
  }

  .testimonial-card {
    display: flex;
    flex-direction: column;
    width: 100%;
  }

  /* Every odd slide will have text above image */
  .glide__slide:nth-child(odd) .testimonial-card {
    flex-direction: column-reverse;
    margin-top: 2.5rem;
  }

  .testimonial-card p {
    margin: 1.5rem 0;
  }

  .testimonial-card img {
    width: 100%;
    height: auto;
    display: block;
    max-width: 100%;
  }

  .glide__bullets {
    display: flex;
    justify-content: flex-start;
    gap: 1rem;
  }

  .glide__bullet {
    width: 12px;
    height: 12px;
    border: none;
    padding: 0;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .glide__bullet--active {
    background-color: white;
    width: 36px;
    border-radius: 6px;
  }

  @media screen and (max-width: 768px) {
    .testimonial-slider {
      padding-right: 0;
      padding-left: 0;
    }
  }
</style>

<script>
  import Glide from "@glidejs/glide";

  document.addEventListener("DOMContentLoaded", () => {
    const glide = new Glide(".glide", {
      type: "carousel",
      perView: 3,
      gap: 20,
      autoplay: 5000,
      animationDuration: 500,
      breakpoints: {
        768: {
          perView: 1,
        },
        1024: {
          perView: 2,
        },
        1408: {
          perView: 3,
        },
      },
    });

    glide.mount();
  });
</script>
